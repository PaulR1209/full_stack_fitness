{% extends 'base.html' %}
{% load static %}
{% load crispy_forms_tags %}

{% block content %}
<div class="container cart-container mt-5">
    <div class="row justify-content-center">
        <div>
            <h2 class="text-center mb-4">Checkout</h2>

            <form method="post" novalidate id="payment-form">  <!-- Added id for JavaScript reference -->
                {% csrf_token %}
                {{ order_form|crispy }}

                <div class="form-group">
                    <label for="card-element" class="form-label">Card Details*</label>
                    <div id="card-element" class="form-control"></div>
                    <div id="card-errors" role="alert" class="invalid-feedback"></div>
                </div>

                <input type="hidden" id="client-secret" value="{{ client_secret }}"> <!-- Hidden input for client secret -->
                
                <div class="d-grid">
                    <button type="submit" class="btn btn-primary btn-lg">Pay Now</button>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
{{ block.super }}
{{ stripe_public_key|json_script:"id_stripe_public_key" }}
{{ client_secret|json_script:"id_client_secret" }}
{% endblock %}